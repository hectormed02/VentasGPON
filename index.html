<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
  <div class="container">
    <h2>Registrar Datos en Google Sheets</h2>
    <form id="formularioSheets" onsubmit="enviarDatos(event)">
      
      <div class="row">
        <div class="col-md-6 mb-3">
          <label>Columna B:</label>
          <input type="text" class="form-control" id="colB" required>
        </div>
        <div class="col-md-6 mb-3">
          <label>Columna C:</label>
          <input type="text" class="form-control" id="colC">
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label>Columna F:</label>
          <input type="text" class="form-control" id="colF">
        </div>
        <div class="col-md-4 mb-3">
          <label>Columna G:</label>
          <input type="text" class="form-control" id="colG">
        </div>
        <div class="col-md-4 mb-3">
          <label>Columna H:</label>
          <input type="text" class="form-control" id="colH">
        </div>
      </div>

      <div class="row">
         <div class="col-md-12 mb-3">
          <label>Columna AB:</label>
          <input type="text" class="form-control" id="colAB">
        </div>
      </div>

      <button type="submit" class="btn btn-primary" id="btnGuardar">Guardar Registro</button>
      <div id="mensaje" class="mt-3 fw-bold"></div>
    </form>
  </div>

  <script>
    function enviarDatos(event) {
      event.preventDefault(); // Evita que la página se recargue
      
      // Mostrar mensaje de carga
      document.getElementById('mensaje').innerText = "Guardando...";
      document.getElementById('btnGuardar').disabled = true;

      // Recolectar datos del formulario
      const datos = {
        colB: document.getElementById('colB').value,
        colC: document.getElementById('colC').value,
        colF: document.getElementById('colF').value,
        colG: document.getElementById('colG').value,
        colH: document.getElementById('colH').value,
        // ... añadir las demás columnas aquí
        colAB: document.getElementById('colAB').value
      };

      // Llamar a la función del servidor (Código.gs)
      google.script.run
        .withSuccessHandler(function(respuesta) {
           document.getElementById('mensaje').innerText = respuesta;
           document.getElementById('mensaje').className = "mt-3 fw-bold text-success";
           document.getElementById('formularioSheets').reset(); // Limpiar formulario
           document.getElementById('btnGuardar').disabled = false;
        })
        .withFailureHandler(function(error) {
           document.getElementById('mensaje').innerText = "Error: " + error.message;
           document.getElementById('mensaje').className = "mt-3 fw-bold text-danger";
           document.getElementById('btnGuardar').disabled = false;
        })
        .crearRegistro(datos);
    }
  </script>
</body>
</html>